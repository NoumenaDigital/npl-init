package document

@test
function testDocumentApproval(test: Test) -> {
    var editor: Party = partyOf(mapOf(Pair("preferred_username", setOf("editor"))));
    var approver: Party = partyOf(mapOf(Pair("preferred_username", setOf("approver"))));
    var document: Document = Document[editor, approver]("content");
    test.assertEquals(Document.States.created, document.activeState().getOrFail());
    document.edit[editor]("new content");
    test.assertEquals(Document.States.created, document.activeState().getOrFail());
    document.requestReview[editor]();
    test.assertEquals(Document.States.inReview, document.activeState().getOrFail());
    document.approve[approver]();
    test.assertEquals(Document.States.approved, document.activeState().getOrFail());
};